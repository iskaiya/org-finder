<!DOCTYPE html>
<html>
<head>
  <title>Org Finder</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    select, input { margin-right: 10px; margin-bottom: 10px; }
  </style>
</head>
<body>
  <h2>Student Organization Finder</h2>

  <input type="text" id="searchInput" placeholder="Search organization name (partial match supported)" oninput="renderResults()" />
  <select id="sortOption" onchange="renderResults()">
    <option value="name">Sort by Name (Aâ€“Z)</option>
    <option value="date">Sort by Date Established (Newest First)</option>
  </select>

  <select id="categoryFilter" onchange="renderResults()">
    <option value="">All Categories</option>
    <option value="Academic">Academic</option>
    <option value="Sports">Sports</option>
    <option value="Arts">Arts</option>
  </select>

  <select id="campusFilter" onchange="renderResults()">
    <option value="">All Campuses</option>
    <option value="University-Wide">University-Wide</option>
    <option value="CCIS">CCIS</option>
    <option value="CE">CE</option>
    <option value="COC">COC</option>
  </select>

  <ul id="resultsList"></ul>

  <script>
    const organizations = [
      { name: "Cisco NetConnect PUP", description: "Technology and cybersecurity", date: "2024", category: "Academic", campus: "University-Wide" },
      { name: "PUP Radical Judo Club", description: "Judo varsity team", date: "2013", category: "Sports", campus: "University-Wide" },
      { name: "PUP Aggregates", description: "For civil engineering students", date: "2010", category: "Academic", campus: "CE" },
      { name: "PUP Association of Students in Computer Intelligence Integration (ASCII)", description: "Official academic org of Dept. of Computer Science", date: "2011", category: "Academic", campus: "CCIS" },
      { name: "Teatro Komunikado", description: "Theater and production org of PUP-COC", date: "2010", category: "Arts", campus: "COC" }
    ];

    function quickSort(arr, keyFn) {
      if (arr.length <= 1) return arr;
      const pivot = arr[0];
      const left = arr.slice(1).filter(x => keyFn(x) < keyFn(pivot));
      const right = arr.slice(1).filter(x => keyFn(x) >= keyFn(pivot));
      return [...quickSort(left, keyFn), pivot, ...quickSort(right, keyFn)];
    }

    // Modified binary search for partial matching
    function binaryPartialSearch(arr, keyword) {
      const matches = [];
      let low = 0, high = arr.length - 1;
      keyword = keyword.toLowerCase();
      let mid;

      // Find an initial match
      while (low <= high) {
        mid = Math.floor((low + high) / 2);
        const name = arr[mid].name.toLowerCase();
        if (name.includes(keyword)) break;
        if (name < keyword) low = mid + 1;
        else high = mid - 1;
      }

      // No match found
      if (low > high) return [];

      // Expand around mid to collect all partial matches
      let left = mid;
      while (left >= 0 && arr[left].name.toLowerCase().includes(keyword)) {
        left--;
      }
      let right = mid;
      while (right < arr.length && arr[right].name.toLowerCase().includes(keyword)) {
        right++;
      }

      return arr.slice(left + 1, right);
    }

    function renderResults() {
      const keyword = document.getElementById("searchInput").value.trim().toLowerCase();
      const sortBy = document.getElementById("sortOption").value;
      const category = document.getElementById("categoryFilter").value;
      const campus = document.getElementById("campusFilter").value;

      let filtered = organizations.filter(org =>
        (category === "" || org.category === category) &&
        (campus === "" || org.campus === campus)
      );

      // Sort before binary search
      if (sortBy === "name") {
        filtered = quickSort(filtered, org => org.name.toLowerCase());
      } else if (sortBy === "date") {
        filtered = quickSort(filtered, org => -new Date(org.date));
      }

      // Apply partial binary search only if keyword is provided
      if (keyword !== "") {
        filtered = binaryPartialSearch(filtered, keyword);
      }

      const resultsList = document.getElementById("resultsList");
      resultsList.innerHTML = "";

      if (filtered.length === 0) {
        resultsList.innerHTML = "<li>No matching organizations found.</li>";
        return;
      }

      filtered.forEach(org => {
        const li = document.createElement("li");
        li.textContent = `${org.name} - ${org.description} (Category: ${org.category}, Campus: ${org.campus}, Established: ${org.date})`;
        resultsList.appendChild(li);
      });
    }

    renderResults();
  </script>
</body>
</html>
